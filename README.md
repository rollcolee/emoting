# Emoting - Rotation Based Dating Service

## 📌 프로젝트 개요
**Emoting**은 사용자의 비언어적 표현(포즈 및 표정)을 분석하여 소셜 인터랙션을 개선하는 로테이션 소개팅 서비스입니다. 실시간으로 자세 및 표정을 감지하여 데이터 기반의 피드백을 제공합니다.

## 📊 데이터 수집 및 처리
### 1️⃣ 포즈 데이터 수집
- **목적**: 특정 포즈를 인식하기 위한 데이터셋 구축
- **방법**:
  - 이미지 크롤링을 통해 직접 데이터셋 구축 (평균 500장)
  - 7가지 행동 라벨 정의:
    - 다리 꼬기
    - 팔짱 끼기
    - 머리 넘기기
    - 턱 만지기
    - 입 가리고 웃기
    - 마시기
    - 먹기

- **포즈 좌표 데이터 (CSV)**
  - 총 33개의 랜드마크 별 X, Y, Z 좌표 저장
  - Mediapipe를 활용하여 좌표 추출

### 2️⃣ 표정 데이터 수집
- **목적**: 사용자의 감정 분석을 위한 표정 데이터 구축
- **방법**:
  - Kaggle ‘FER-2013’ 데이터셋 활용 (약 16만 장 이미지)
  - 7가지 감정 라벨:
    - Happy
    - Sad
    - Neutral
    - Fear
    - Surprise
    - Disgust
    - Angry
  - 표정별 25개의 랜드마크 좌표 (X, Y, Z) 저장

### 3️⃣ 데이터 전처리
- 불필요한 컬럼 제거 (이미지명 등)
- 포즈 이미지 크롤링 후 저품질 데이터 필터링
- 표정 인식이 어려운 이미지 자동 제거

## 🤖 모델 학습 및 성능 평가
### 1️⃣ 포즈 인식 모델
- **랜덤포레스트** (Accuracy: 0.93, Cross-Validation Accuracy: 0.89)
  - 테스트 영상에서 예측 성능 저조 → PCA 차원축소 후 개선 시도
  - 상체/하체 모델 분류 후 예측 성능 향상되었으나 활용도 문제로 보류
- **XGBoost (Test Accuracy: 0.8703)**
  - 상체/하체 구분 없이도 예측 성능 우수
  - 입력 이미지의 회전 문제 해결 후 성능 향상 → 최종 선택

### 2️⃣ 표정 인식 모델
- **XGBoost (좌표 기반)**
  - Accuracy: 0.4704 → 테스트 영상에서 예측 성능 저조
- **CNN (이미지 기반)**
  - Accuracy: 0.4067 (훈련 데이터 3000장, 테스트 600장 사용)
  - 화질 저하로 인해 성능 저조 → 업스케일링 시도했으나 효과 미비
  - 테스트 영상에서는 CNN이 XGBoost보다 우수하여 최종 선택

## 🏗️ 메인 모델 구축
### 1️⃣ Pose & Face 좌표 활용 모델
- **입력 데이터**: Mediapipe를 통해 포즈 및 표정 좌표 추출
- **모델**: 학습된 XGBoost, CNN 모델을 활용하여 행동 감지
- **출력**: 각 행동 및 표정별 횟수 카운트 → 가중치 반영 후 최종 점수 산출

### 2️⃣ Pose 좌표 + Face 이미지 활용 모델
- 포즈 인식: Mediapipe → XGBoost 모델
- 표정 인식: CNN 모델 활용
- 횟수 카운트 및 가중치 적용 후 최종 점수 계산

```python
pose_weights = {
    'crossed_arm': -3,
    'crossed_leg': -1.5,
    'smile_cover': +2,
    'touching_chin': +1,
    'hair_comb': 1.5,
    'drinking': 0,
    'eating': 0
}

face_weights = {
    'angry': -3,
    'disgust': -2,
    'fear': -1,
    'happy': +3,
    'neutral': 0,
    'sad': -1,
    'surprise': 0
}
```

## 📡 디바이스 연동
- **하드웨어**: Raspberry Pi + 웹캠 연동
- **백엔드**:
  - 라즈베리파이에서 직접 모델 실행
  - DB 구축이 없어 점수 계산 함수를 코드에 포함하여 구현
  - 휴대성이 높아 소형 웹캠 활용 가능

## 🔄 결론 및 향후 개선점
### ✅ 성과
- 실시간 자세 및 표정 인식 기능 탑재 프로토타입 개발 완료
- 행동 및 표정 분석을 기반으로 사용자 피드백 제공 가능

### 🔄 향후 개선 방향
- 다중 인물 감지 및 행동 인식 추가
- 표정 변화에 따른 감정 분석 모델 고도화
- 추가 데이터 수집 및 모델 정밀도 향상
- 행동 비율 기반 분석 기능 추가
- DB 구축을 통한 데이터 저장 및 가중치 관리

---

이 프로젝트는 비언어적 커뮤니케이션 분석을 통해 소셜 인터랙션을 개선하는 데 초점을 맞추고 있습니다. 향후 지속적인 개선을 통해 더욱 정밀한 분석이 가능하도록 발전시킬 예정입니다.


